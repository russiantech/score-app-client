import{b as i,c as S,d as C,r as o,j as e,P as k,S as u,L as A}from"./index-DdAdIi6n.js";const T=s=>{const t=s;return t?.response?.data?.message||t?.response?.data?.detail||t?.message||"An unexpected admin operation error occurred"},d=s=>new Error(T(s)),D={async getStats(){try{return(await i.json.get("/admin/stats")).data.data}catch(s){throw d(s)}},async getRecentActivities(s=10){try{return(await i.json.get("/admin/activities",{params:{limit:s}})).data.data}catch(t){throw d(t)}},async getDashboardOverview(){try{return(await i.json.get("/admin/dashboard")).data.data}catch(s){throw d(s)}},async assignTutorToCourse(s,t){try{return(await i.json.post("/courses/assign-tutor",{tutorId:s,courseId:t})).data}catch(n){throw d(n)}},async unassignTutorFromCourse(s){try{return(await i.json.post(`/admin/courses/${s}/unassign-tutor`)).data}catch(t){throw d(t)}}},g=s=>{if(!s||typeof s!="object")return s;const t={};return Object.keys(s).forEach(n=>{const l=n.replace(/_([a-z])/g,(a,r)=>r.toUpperCase());t[l]=s[n]}),t},h=({icon:s,iconColor:t,value:n,label:l,warning:a,info:r})=>e.jsx("div",{className:"col-12 col-md-6 mb-3",children:e.jsxs("div",{className:"d-flex align-items-center p-3 bg-light rounded-3 h-100",children:[e.jsx("div",{className:"me-3 flex-shrink-0",children:e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px",background:`${t}15`},children:e.jsx("i",{className:`fa ${s} fa-lg ${t}`})})}),e.jsxs("div",{className:"flex-grow-1 min-w-0",children:[e.jsx("h5",{className:"mb-0 fw-bold",children:n}),e.jsx("small",{className:"text-muted text-truncate d-block",children:l}),a&&a.count>0&&e.jsx("div",{className:"mt-1",children:e.jsxs("small",{className:"text-warning d-block text-truncate",children:[e.jsx("i",{className:"fa fa-exclamation-triangle me-1"}),a.count," ",a.text]})}),r&&r.count>0&&e.jsx("div",{className:"mt-1",children:e.jsxs("small",{className:"text-info d-block text-truncate",children:[e.jsx("i",{className:"fa fa-arrow-up me-1"}),r.count," ",r.text]})})]})]})}),W=({stats:s})=>s.coursesWithoutTutors===0&&s.studentsWithoutParents===0?null:e.jsx("div",{className:"row mb-4",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"alert alert-warning border-0 shadow-sm mb-0",children:e.jsxs("div",{className:"d-flex flex-column flex-md-row align-items-start align-items-md-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:"fa fa-exclamation-triangle fa-2x"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"alert-heading mb-1 fw-bold",children:"Attention Required"}),e.jsxs("div",{className:"d-flex gap-3 flex-wrap small",children:[s.coursesWithoutTutors>0&&e.jsxs("span",{children:[e.jsx("strong",{children:s.coursesWithoutTutors})," course",s.coursesWithoutTutors!==1?"s":""," without tutors"]}),s.studentsWithoutParents>0&&e.jsxs("span",{children:[e.jsx("strong",{children:s.studentsWithoutParents})," student",s.studentsWithoutParents!==1?"s":""," not linked to parents"]})]})]}),e.jsx("div",{className:"d-flex gap-2 flex-wrap flex-shrink-0",children:s.coursesWithoutTutors>0&&e.jsxs(A,{to:"/admin/courses",className:"btn btn-sm btn-warning",children:[e.jsx("i",{className:"fa fa-link me-1 d-none d-sm-inline"}),"Link Parents"]})})]})})})}),P=()=>{const{openCreateModal:s,refreshTrigger:t}=S(),{openCreateModal:n,refreshTrigger:l}=C(),[a,r]=o.useState(null),[,x]=o.useState([]),[c,j]=o.useState(!0),[b,p]=o.useState(null),v={total:150,active:120,inactive:30,totalUsers:150,activeUsers:120,totalCourses:25,totalModules:75,totalLessons:200,totalTutors:15,totalStudents:100,totalParents:35,activeCourses:20,inactiveCourses:5,activeStudents:90,activeTutors:12,activeParents:30,inactiveParents:5,recentEnrollments:12,totalEnrollments:150,totalAssessments:300,averageClassSize:15,coursesWithoutTutors:2,studentsWithoutParents:10},N=[{id:"1",type:"enrollment",message:"John Doe enrolled in Full Stack Web Development",timestamp:new Date(Date.now()-7200*1e3).toISOString(),user:{id:"1",name:"John Doe"}},{id:"2",type:"course",message:'New course "Advanced Machine Learning" created',timestamp:new Date(Date.now()-300*60*1e3).toISOString(),user:{id:"2",name:"Admin User"}},{id:"3",type:"user",message:"Sarah Williams registered as new tutor",timestamp:new Date(Date.now()-1440*60*1e3).toISOString(),user:{id:"3",name:"Sarah Williams"}},{id:"4",type:"assessment",message:"Python Basics Quiz completed by 25 students",timestamp:new Date(Date.now()-2160*60*1e3).toISOString()},{id:"5",type:"attendance",message:"Attendance recorded for Web Development class",timestamp:new Date(Date.now()-2880*60*1e3).toISOString()}];o.useEffect(()=>{f()},[t,l]);const f=async()=>{try{j(!0),p(null);const m=await D.getDashboardOverview(),w=g(m.stats),y=m.activities.map(g);r(w),x(y)}catch(m){console.warn("Using static data:",m),r(v),x(N)}finally{j(!1)}};return c?e.jsx(k,{}):b?e.jsx("div",{className:"container-fluid p-3 p-md-4",children:e.jsx("div",{className:"alert alert-danger border-0 shadow-sm",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"fa fa-exclamation-triangle fa-2x me-3"}),e.jsxs("div",{children:[e.jsx("h6",{className:"alert-heading mb-1",children:"Error Loading Dashboard"}),e.jsx("p",{className:"mb-0",children:b})]})]})})}):e.jsx("div",{className:"admin-dashboard",children:e.jsxs("div",{className:"container-fluid p-2 p-md-3 p-lg-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-1 fw-bold",children:"Admin Dashboard"}),e.jsx("p",{className:"text-muted mb-0",children:"Welcome to Score Academy Management"})]}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>n("student"),children:[e.jsx("i",{className:"fa fa-user-plus me-1 d-none d-sm-inline"}),e.jsx("span",{className:"d-none d-sm-inline",children:"Add User"}),e.jsx("span",{className:"d-inline d-sm-none",children:"User"})]}),e.jsxs("button",{className:"btn btn-sm btn-success",onClick:()=>s(),children:[e.jsx("i",{className:"fa fa-plus me-1 d-none d-sm-inline"}),e.jsx("span",{className:"d-none d-sm-inline",children:"New Course"}),e.jsx("span",{className:"d-inline d-sm-none",children:"Course"})]}),e.jsxs("button",{className:"btn btn-sm btn-outline-secondary",onClick:f,children:[e.jsx("i",{className:"fa fa-sync-alt"}),e.jsx("span",{className:"d-none d-sm-inline ms-1",children:"Refresh"})]})]})]})}),e.jsxs("div",{className:"row g-3 mb-4",children:[e.jsx(u,{icon:"fa fa-users",bgColor:"bg-primary",value:a?.total||0,label:"Total Users",loading:c}),e.jsx(u,{icon:"fa fa-book",bgColor:"bg-success",value:a?.totalCourses||0,label:"Total Courses",loading:c}),e.jsx(u,{icon:"fa fa-chalkboard-teacher",bgColor:"bg-info",value:a?.totalTutors||0,label:"Tutors",loading:c}),e.jsx(u,{icon:"fa fa-user-graduate",bgColor:"bg-warning",value:a?.totalStudents||0,label:"Students",loading:c})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-6 col-lg-3 mb-3",children:e.jsx("div",{className:"card border-0 shadow-sm h-100",children:e.jsxs("div",{className:"card-body p-3 text-center",children:[e.jsx("div",{className:"mb-2",children:e.jsx("div",{className:"rounded-circle d-inline-flex align-items-center justify-content-center",style:{width:"48px",height:"48px",background:"#667eea15"},children:e.jsx("i",{className:"fa fa-layer-group text-primary"})})}),e.jsx("h5",{className:"mb-0 fw-bold",children:a?.totalModules||0}),e.jsx("small",{className:"text-muted",children:"Total Modules"})]})})}),e.jsx("div",{className:"col-6 col-lg-3 mb-3",children:e.jsx("div",{className:"card border-0 shadow-sm h-100",children:e.jsxs("div",{className:"card-body p-3 text-center",children:[e.jsx("div",{className:"mb-2",children:e.jsx("div",{className:"rounded-circle d-inline-flex align-items-center justify-content-center",style:{width:"48px",height:"48px",background:"#10b98115"},children:e.jsx("i",{className:"fa fa-list text-success"})})}),e.jsx("h5",{className:"mb-0 fw-bold",children:a?.totalLessons||0}),e.jsx("small",{className:"text-muted",children:"Total Lessons"})]})})}),e.jsx("div",{className:"col-6 col-lg-3 mb-3",children:e.jsx("div",{className:"card border-0 shadow-sm h-100",children:e.jsxs("div",{className:"card-body p-3 text-center",children:[e.jsx("div",{className:"mb-2",children:e.jsx("div",{className:"rounded-circle d-inline-flex align-items-center justify-content-center",style:{width:"48px",height:"48px",background:"#0dcaf015"},children:e.jsx("i",{className:"fa fa-clipboard-list text-info"})})}),e.jsx("h5",{className:"mb-0 fw-bold",children:a?.totalAssessments||0}),e.jsx("small",{className:"text-muted",children:"Assessments"})]})})}),e.jsx("div",{className:"col-6 col-lg-3 mb-3",children:e.jsx("div",{className:"card border-0 shadow-sm h-100",children:e.jsxs("div",{className:"card-body p-3 text-center",children:[e.jsx("div",{className:"mb-2",children:e.jsx("div",{className:"rounded-circle d-inline-flex align-items-center justify-content-center",style:{width:"48px",height:"48px",background:"#ffc10715"},children:e.jsx("i",{className:"fa fa-user-check text-warning"})})}),e.jsx("h5",{className:"mb-0 fw-bold",children:a?.recentEnrollments||0}),e.jsx("small",{className:"text-muted",children:"New Enrollments"})]})})})]}),a&&e.jsx(W,{stats:a}),e.jsx("div",{className:"row mb-4",children:e.jsx("div",{className:"col-12 mb-3 mb-lg-0",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header bg-white border-0 py-3",children:e.jsxs("h6",{className:"mb-0 fw-semibold",children:[e.jsx("i",{className:"fa fa-chart-line me-2 text-primary"}),"System Overview"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row g-3",children:[e.jsx(h,{icon:"fa-graduation-cap",iconColor:"text-primary",value:a?.activeCourses||0,label:"Active Courses",warning:a?.coursesWithoutTutors?{text:"without tutor",count:a.coursesWithoutTutors}:void 0}),e.jsx(h,{icon:"fa-user-check",iconColor:"text-success",value:a?.totalEnrollments||0,label:"Total Enrollments",info:a?.recentEnrollments?{text:"last 7 days",count:a.recentEnrollments}:void 0}),e.jsx(h,{icon:"fa-users",iconColor:"text-info",value:a?.averageClassSize||0,label:"Avg. Class Size"}),e.jsx(h,{icon:"fa-user-friends",iconColor:"text-warning",value:a?.totalParents||0,label:"Parent Accounts",warning:a?.studentsWithoutParents?{text:"students unlinked",count:a.studentsWithoutParents}:void 0})]})})]})})})]})})};export{P as AdminDashboard,P as default};
