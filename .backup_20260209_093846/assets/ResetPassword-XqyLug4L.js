import{a as b,u as S,r as a,j as e,L as h,N as r}from"./index-Bhp7YlUb.js";import{A as C}from"./AuthHeader-DAwxNHMC.js";const c=3,y=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/,i=6,T=()=>{const w=b(),{resetPassword:p}=S(),[o,x]=a.useState(""),[n,N]=a.useState(""),[l,f]=a.useState(""),[t,g]=a.useState(!1),[d,m]=a.useState(!1),j=s=>s?s.length<c?`Password must be at least ${c} characters`:y.test(s)?null:"Password must contain uppercase, lowercase, and a number":"Password is required",v=async s=>{if(s.preventDefault(),!o||o.length!==i)return r.showToast(`Reset code must be ${i} characters`,"error");const u=j(n);if(u)return r.showToast(u,"error");if(n!==l)return r.showToast("Passwords do not match","error");m(!0);try{await p({reset_code:o.trim().toUpperCase(),new_password:n}),r.showToast("Password reset successful! Redirecting to sign in...","success"),setTimeout(()=>w("/auth/signin"),1500)}catch(P){r.showToast(P?.message||"Invalid or expired reset code. Please try again.","error")}finally{m(!1)}};return e.jsx("main",{className:"page-content",children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"dz-authentication-area",children:[e.jsx(C,{}),e.jsxs("div",{className:"section-head",children:[e.jsx("h3",{className:"title",children:"Reset Password"}),e.jsx("p",{children:"Enter the reset code you received and choose a new password."})]}),e.jsxs("form",{onSubmit:v,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label",children:"Reset Code"}),e.jsx("input",{type:"text",className:"form-control text-center",value:o,onChange:s=>x(s.target.value.toUpperCase()),placeholder:"Enter 6-digit code",maxLength:i,required:!0,style:{letterSpacing:"0.5em",fontSize:"1.2rem"}}),e.jsxs("small",{className:"form-text text-muted",children:["Enter the ",i,"-digit code sent to your email"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label",children:"New Password"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:t?"text":"password",className:"form-control",value:n,onChange:s=>N(s.target.value),placeholder:"Enter new password",required:!0,autoComplete:"new-password"}),e.jsx("span",{className:"input-group-text",onClick:()=>g(!t),role:"button","aria-label":t?"Hide password":"Show password",style:{cursor:"pointer"},children:t?"ðŸ‘":"ðŸ‘â€ðŸ—¨"})]}),e.jsxs("small",{className:"form-text text-muted",children:["Minimum ",c," characters with uppercase, lowercase, and number"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label",children:"Confirm Password"}),e.jsx("input",{type:t?"text":"password",className:"form-control",value:l,onChange:s=>f(s.target.value),placeholder:"Confirm new password",required:!0,autoComplete:"new-password"})]}),e.jsx("button",{type:"submit",className:"btn btn-primary w-100",disabled:d,children:d?"Resetting Password...":"Reset Password"}),e.jsx("div",{className:"text-center mt-3",children:e.jsx(h,{to:"/auth/forgot-password",className:"text-primary",children:"Didnâ€™t receive a code? Request a new one"})}),e.jsx("div",{className:"text-center mt-2",children:e.jsx(h,{to:"/auth/signin",className:"text-muted",children:"Back to Sign In"})})]})]})})})};export{T as default};
